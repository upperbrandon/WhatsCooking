title = "Tuition vs Percent Placement by School",
x = "School"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(face = "bold", size = 16, hjust = 0.5)
)
View(numeric_data)
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "darkorange") +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "darkorange") +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "darkorange") +
geom_text(vjust = -1, size = 2) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.3, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_x_continuous(labels = comma) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(alpha = 0.5, color = "darkorange") +
geom_text(vjust = -1, size = 3) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange") +
geom_text(vjust = -1, size = 3) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange") +
geom_text(vjust = -1, size = 5) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Scatter plot with color gradient
ggplot(schools, aes(x = Tuition, y = Placement, label = School, color = Placement)) +
geom_point(size = 6, alpha = 0.8) +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_color_gradient(low = "orange", high = "darkgreen") +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
color = "Placement %"
) +
theme_minimal(base_size = 14)
# Scatter plot with color gradient
ggplot(schools, aes(x = Tuition, y = Placement, label = School, color = Placement)) +
geom_point(size = 6, alpha = 0.8) +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_color_gradient(low = "white", high = "blue") +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
color = "Placement %"
) +
theme_minimal(base_size = 14)
# Scatter plot with color gradient
ggplot(schools, aes(x = Tuition, y = Placement, label = School, color = Placement)) +
geom_point(size = 6, alpha = 0.8) +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_color_gradient(low = "grey", high = "blue") +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
color = "Placement %"
) +
theme_minimal(base_size = 14)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange") +
geom_text(vjust = -1, size = 5) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
)
# Bubble chart with larger x and y range
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange", size = 6) +
geom_text(vjust = -1, size = 5) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
xlim(0, 100000) +     # increase x-axis range
ylim(60, 100) +       # increase y-axis range
theme_minimal(base_size = 14)
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "SF", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart with larger x and y range
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange", size = 6) +
geom_text(vjust = -1, size = 5) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
xlim(0, 100000) +     # increase x-axis range
ylim(60, 100) +       # increase y-axis range
theme_minimal(base_size = 14)
# Load libraries
library(ggplot2)
library(scales)  # for comma formatting
# Create data frame
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Plot
ggplot(schools, aes(x = reorder(School, -Tuition))) +
geom_bar(aes(y = Tuition/1000), stat = "identity", fill = "skyblue") +
geom_line(aes(y = Placement*10, group = 1), color = "red", size = 1.5) +
geom_point(aes(y = Placement*10), color = "red", size = 3) +
scale_y_continuous(
name = "Tuition (in $1000s)",
sec.axis = sec_axis(~./10, name = "Placement (%)")
) +
labs(
x = "School",
title = "Tuition vs Placement Percentage by School"
) +
theme_minimal(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "orange") +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
theme_minimal(base_size = 14)
library(ggplot2)
library(scales)
# Data
schools <- data.frame(
School = c("Rice", "MIT", "BYU", "Standford", "Cornell", "University of Texas"),
Tuition = c(76073, 89000, 15992, 85755, 86596, 55196),
Placement = c(72.2, 88.9, 87, 88, 81, 86)
)
# Bubble chart
ggplot(schools, aes(x = Tuition, y = Placement, size = Tuition, label = School)) +
geom_point(alpha = 0.6, color = "orange") +
geom_text(vjust = -1, size = 4) +
scale_x_continuous(labels = comma) +
scale_size(range = c(5, 15)) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
xlim(0, 100000) +     # increase x-axis range
ylim(60, 100) +
theme_minimal(base_size = 14)
library(ggplot2)
library(ggrepel)
# Bubble chart with non-overlapping labels
ggplot(schools, aes(x = Tuition, y = Placement, label = School)) +
geom_point(color = "darkorange", size = 6) +
geom_text_repel(size = 5, box.padding = 0.5, point.padding = 0.5) +
labs(
x = "Tuition ($)",
y = "Placement (%)",
title = "School Tuition vs Placement Percentage",
size = "Tuition"
) +
xlim(0, 100000) +
ylim(60, 100) +
theme_minimal(base_size = 14)
# Load Libraries ----------------------------------------------------------
library(tidyverse)
library(tidymodels)
library(vroom)
library(skimr)
library(DataExplorer)
library(patchwork)
library(glmnet)
library(ranger)
library(ggmosaic)
library(embed)
library(tensorflow)
library(themis)
library(jsonlite)
library(tidytext)
library(dplyr)
library(textrecipes)
setwd("~/GitHub/WhatsCooking")
trainSet <- read_file("train.json") %>%
fromJSON()
testSet <- read_file("test.json") %>%
fromJSON()
# Make sure ingredients is a text column
trainSet <- trainSet %>% mutate(ingredients = map_chr(ingredients, ~ paste(.x, collapse = " ")))
testSet  <- testSet  %>% mutate(ingredients = map_chr(ingredients, ~ paste(.x, collapse = " ")))
# ---- TF-IDF Recipe ----
my_recipe <- recipe(cuisine ~ ingredients, data = trainSet) %>%
step_tokenize(ingredients) %>%          # tokenize text
step_tokenfilter(ingredients, max_tokens = 500) %>%
step_tfidf(ingredients)
# trainSet %>%
#   unnest(ingredients) %>%
#   slice(1:10)
#
# testSet %>%
#   unnest(ingredients)
# Ingredient_Total <- trainSet %>%
#   mutate(ingredient_count = lengths(ingredients)) %>%
#   select(id, cuisine, ingredient_count)
#
# Ingredient_Milk <- trainSet %>%
#   mutate(ingredient_Milk = grepl("milk",
#                                  tolower(paste(ingredients, collapse=" ")))) %>%
#   select(id, cuisine, ingredient_Milk)
#
# Ingredient_honey <- trainSet %>%
#   mutate(ingredient_honey = grepl("milk",
#                                  tolower(paste(ingredients, collapse=" ")))) %>%
#   select(id, cuisine, ingredient_honey)
#
# train_data <- trainSet %>%
#   mutate(
#     ingredient_count = lengths(ingredients),
#     ingredient_Milk = map_lgl(ingredients, ~ any(grepl("milk", tolower(.)))),
#     ingredient_Egg  = map_lgl(ingredients, ~ any(grepl("egg", tolower(.))))
#   ) %>%
#   select(id, cuisine, ingredient_count, ingredient_Milk, ingredient_Egg)
#
# test_data <- testSet %>%
#   mutate(
#     ingredient_count = lengths(ingredients),
#     ingredient_Milk = map_lgl(ingredients, ~ any(grepl("milk", tolower(.)))),
#     ingredient_Egg  = map_lgl(ingredients, ~ any(grepl("egg", tolower(.))))
#   ) %>%
#   select(id, ingredient_count, ingredient_Milk, ingredient_Egg)
#
# my_recipe <- recipe(cuisine ~ ., data = train_data) %>%
#   step_rm(id) %>%
#   step_dummy(all_nominal_predictors())
my_mod <- rand_forest(
mtry = tune(),
min_n = tune(),
trees = 500
) %>%
set_engine("ranger", importance = "impurity") %>%
set_mode("classification")
grid_of_tuning_params <- grid_regular(
mtry(range = c(2, 3)),
min_n(range = c(2, 10)),
levels = 3
)
folds <- vfold_cv(trainSet, v = 5, strata = cuisine)
rf_workflow <- workflow() %>%
add_recipe(my_recipe) %>%
add_model(my_mod)
CV_results <- rf_workflow %>%
tune_grid(
resamples = folds,
grid = grid_of_tuning_params,
metrics = metric_set(roc_auc),
control = control_grid(save_pred = FALSE, verbose = TRUE)
)
bestTune <- select_best(CV_results, metric = "roc_auc")
final_wf <- rf_workflow %>%
finalize_workflow(bestTune) %>%
fit(data = train_data)
final_wf <- rf_workflow %>%
finalize_workflow(bestTune) %>%
fit(data = trainSet)
cuisine_predictions <- predict(
final_wf,
new_data = testSet,
type = "prob"
)
pred_class <- predict(final_wf, testSet) %>%
rename(cuisine = .pred_class)
kaggle_submission <- testSet %>%
select(id) %>%
bind_cols(pred_class)
vroom_write(
kaggle_submission,
file = "./RFPreds.csv",
delim = ","
)
